.TH GIT-SCAN-FOR-LEAKED-ENVS 1 "January 2026" "git-scan-for-leaked-envs" "Git Manual"
.SH NAME
git-scan-for-leaked-envs \- scan repository for leaked secrets and credentials
.SH SYNOPSIS
.B git scan-for-leaked-envs
.RI [ options ]
.SH DESCRIPTION
.B git scan-for-leaked-envs
scans the current repository for potentially leaked environment variables,
API keys, secrets, and other sensitive data using both pattern matching and
GitHub Copilot AI analysis.
.PP
The tool provides recommendations for rotating compromised credentials and
suggests running
.BR git-help-i-pushed-an-env (1)
to clean up the repository history.
.SH OPTIONS
.TP
.BR -h ", " --help
Show help message and exit.
.TP
.BR -v ", " --verbose
Show detailed scan output including debug information.
.TP
.B --json
Output results in JSON format instead of human-readable format.
.TP
.B --no-recommend
Skip the credential rotation recommendations section.
.TP
.B --include-history
Scan git history for secrets, not just current files. This may take
significantly longer for repositories with extensive history.
.TP
.BI --output " FILE"
Write scan results to the specified file.
.SH PATTERNS DETECTED
The scanner looks for common secret patterns including:
.TP
.B AWS Credentials
AWS Access Key IDs (AKIA...) and secret access keys.
.TP
.B GitHub Tokens
Personal access tokens (ghp_), OAuth tokens (gho_), and fine-grained PATs.
.TP
.B OpenAI API Keys
Keys starting with sk- or sk-proj-.
.TP
.B Slack Tokens
Bot and user tokens (xoxb-, xoxp-, etc.).
.TP
.B Private Keys
RSA, DSA, ECDSA, Ed25519, and PGP private keys.
.TP
.B Database Connection Strings
PostgreSQL, MySQL, MongoDB, and Redis URLs with embedded credentials.
.TP
.B Generic Patterns
Common password, secret, and API key variable patterns.
.SH SENSITIVE FILES
The following file types are flagged as potentially sensitive:
.PP
.RS
.nf
.env, .env.local, .env.production, etc.
*.pem, *.key, *.p12, *.pfx, *.jks
id_rsa, id_dsa, id_ecdsa, id_ed25519
.npmrc, .pypirc, .netrc, .htpasswd
credentials.json, secrets.json, secrets.yml
*.log (may contain printed secrets)
.fi
.RE
.SH AI ANALYSIS
When GitHub Copilot CLI is available, the tool performs an AI-powered
security analysis that can identify:
.PP
.RS
.IP \(bu 2
Hardcoded secrets that may not match standard patterns
.IP \(bu 2
Environment variables containing sensitive data
.IP \(bu 2
Files that should not be committed to version control
.IP \(bu 2
Context-aware security recommendations
.RE
.SH EXIT STATUS
.TP
.B 0
No security issues found.
.TP
.B 1
Potential secrets or sensitive files were found.
.TP
.B 2
An error occurred during scanning.
.SH EXAMPLES
.TP
.B git scan-for-leaked-envs
Run a basic scan of the current repository.
.TP
.B git scan-for-leaked-envs --verbose
Run a detailed scan with debug output.
.TP
.B git scan-for-leaked-envs --include-history
Scan both current files and git history.
.TP
.B git scan-for-leaked-envs --json --output report.json
Output results in JSON format to a file.
.SH SEE ALSO
.BR git-help-i-pushed-an-env (1),
.BR git-upload (1),
.BR copilot (1)
.SH AUTHOR
Generated by GitHub Copilot.
